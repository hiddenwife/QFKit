# Financial Analysis & Simulation Toolkit

A modular Python toolkit for sophisticated **time-series analysis**, **portfolio construction**, **stochastic simulation**, and **Bayesian forecasting**. It leverages a responsive and intuitive GUI built with `PySide6` to make advanced quantitative tools accessible to everyone.

This toolkit is **Windows**, **Linux** and **macOS** compatible (Windows 11, Ubuntu 24.04 and MacOS 15.6.1).

## Quick Start
**Recommended**: Make a new virtual environment, then run:
```bash
pip install -r requirements.txt
python main.py
```
- **Note**: `pytensor` needs a c++ compiler to function properly (g++ on windows/linux, clang++ on macOS).

## Overview and Usage
This application provides a suite of tools for quantitative finance. Load financial tickers from Yahoo Finance, perform statistical analysis, construct and evaluate multi-asset portfolios, and project future performance using stochastic models and a Bayesian forecasting engine.

The integrated workflow allows for rapid iteration between analysis, portfolio construction, and forecasting. The primary goal is to provide a robust platform for evaluating and comparing investment strategies based on quantitative metrics.

This toolkit empowers you to make data-driven investment decisions. Whether you're a student, an investor, or a researcher, this tool provides a powerful, user-friendly platform to explore financial data.

## Core Features
### Data loading & Analysis: 
- **Data Fetching**: Pulls historical OHLCV data via yfinance and computes log returns.
- **Performance Metrics**: Calculates standard industry metrics including CAGR, annualised volatility, and Sharpe Ratio.
- **Growth Probability Models**: Estimates the probability of future price increases over specified horizons using a lognormal price distribution model.

### Portfolio Analytics
- **Portfolio Construction**: Build weighted portfolios from any combination of loaded tickers. Weights are automatically normalised to construct a new portfolio time series.
- **Risk Decomposition**: Generate correlation and covariance matrices for the portfolio's underlying assets.
- **Variance Contribution Analysis**: Quantify each asset's percentage contribution to total portfolio variance.
- **Integrated Portfolio Object**: Once created, a portfolio is treated as a distinct entity that can be passed directly to the simulation and forecasting modules for further analysis.

### Stochastic Simulation Suite:
Run sophisticated Monte Carlo simulations to model future price paths.
- **Geometric Brownian Motion (GBM)**: The industry standard for stock price simulation.
- **Jump-Diffusion (Merton Model)**: Extends GBM to account for sudden, discontinuous price jumps (market shocks).
- **Heston Stochastic Volatility Model**: A dual-process model where asset volatility itself is stochastic, capturing volatility clustering effects.

### Bayesian Forecasting Engine:
This is the most powerful feature of the toolkit, leveraging the `PyMC` library for robust, probabilistic forecasting.
- **Sophisticated Core Model**: An **Autoregressive (AR(p)) model with a Student-T likelihood**. This specification is chosen for its robustness in modeling the heavy-tailed nature of financial returns.
- **Dual Inference Methods**:
  - **Full MCMC (NUTS)**: Employs the No-U-Turn Sampler (a Hamiltonian Monte Carlo method) for the most accurate posterior estimation.
    - You can specify the number of cores (processors) to utilise for parallel processing during intensive computations.
  - **Fast ADVI**: Uses Automatic Differentiation Variational Inference for rapid model fitting when speed is a priority.
- **Probabilistic Forecasts**: The output is a full posterior predictive distribution, not a single point estimate. This is visualised with **50%, 80% and 95% credible intervals** to quantify forecast uncertainty.
- **Interactive Visuals**: Explore forecast results with interactive plots generated by `Plotly`.
- **Comparison to Hisory**: Can run the forecast in a historical (backtesting) mode, which withholds the latest data to compare the model's predictions against the actual historical movements.
- **Robust Parallel Processing Architecture**: The forecast is executed in a **separate, isolated subprocess** (`forecast_worker.py`). This is a critical design choice to ensure **Linux/cross-platform compatibility**, prevent GUI freezing, and avoid known threading issues when combining `PySide6` with the `PyMC` library's parallel MCMC (NUTS) chains.
- **Learn Bias/Variance**: Hierarchical Bias & Volatility Stabilisation. Stabilises drift and volatility estimates, especially for volatile or short histories, by partially pooling them toward an assumed market average.
  - **Note**: Enabling this with MCMC (NUTS) exponentially increases the time taken for sampling, as the sampler must navigate a significantly more complex, high-dimensional parameter space. Reduce `draws` or swap to the faster `ADVI`.

## GUI & Architecture
- **Tabbed Interface**: Functionality is segmented into modules: Data Loading, Analysis, Portfolio, Simulation, and Forecasting.
- **Asynchronous & Responsive UI**: All computationally heavy tasks (MCMC sampling, Monte Carlo simulations) are managed asynchronously. Heavy computations (Bayesian forecasting) are isolated in a **separate sub-process** (`forecast_worker.py`) to prevent GUI freezing and ensure stable parallel computation across operating systems. Lighter tasks (like Monte Carlo) run on `QThread`.
- **Integrated Workflow**: The application architecture is designed to pass data objects (like a constructed portfolio) seamlessly between different tabs.

## Licence
This project is licenced under GNU GENERAL PUBLIC LICENSE Version 3, 29 June 2007. Please see LICENCE.txt for more details.

## Collaboration, Pull Requests & Contact
If you'd like to help improve this project, I’d be really grateful! Contributions, ideas, and bug reports are all welcome. For small fixes or questions you can [open an issue](https://github.com/hiddenwife/QFKit/issues) first to discuss. 

If you want to add code, suggest improvements, or report issues, please open a [pull request](https://github.com/hiddenwife/QFKit/pulls) on GitHub (or email me) with a short description of your change and any relevant tests or screenshots.

- **Email**: github.reflector553@passinbox.com


## Project Structure
financial_tools/

├── main.py

├── gui/

│   ├── __init__.py

│   ├── main_window.py

│   └── tabs/ 

│   │   ├── __init__.py

│   │   ├── analysis_tab.py

│   │   ├── compare_tab.py

│   │   ├── forecast_tab.py

│   │   ├── load_data_tab.py

│   │   ├── portfolio_tab.py

│   │   ├── simulation_tab.py

│   │   └── forecast_worker.py

├── src/

│   ├── analysis.py

│   ├── data_loader.py

│   ├── forecast.py

│   ├── portfolio.py

│   └── simulation.py

├── requirements.txt

└── README.md